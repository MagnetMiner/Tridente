<script>
    // Configuración del Mapa Táctico TRIDENTE
    var map = L.map('map').setView([-33.100, -71.900], 8); // Centrado en la costa central

    L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
        subdomains: 'abcd',
        maxZoom: 19
    }).addTo(map);

    // ESTRATEGIA: ESCUDO SOBERANO CENTRAL (8 NODOS)
    // Coordenadas calculadas para solapamiento táctico y cobertura de 300km lineales.
    var buoys = [
        { name: "TRIDENTE-01 [Norte Profundo]", lat: -32.143, lon: -71.550, desc: "Sector Pichidangui - Alerta Temprana Norte" },
        { name: "TRIDENTE-02 [Acceso Quintero]", lat: -32.707, lon: -71.520, desc: "Sector Horcón - Control Tráfico Hidrocarburos" },
        { name: "TRIDENTE-03 [Defensa Concón]", lat: -32.923, lon: -71.580, desc: "Bahía de Concón - Protección Refinería" },
        { name: "TRIDENTE-04 [Nodo Valparaíso]", lat: -33.018, lon: -71.650, desc: "Punta Ángeles - Control Puerto Principal" },
        { name: "TRIDENTE-05 [Pivote Táctico]", lat: -33.110, lon: -71.750, desc: "Punta Curaumilla - Cobertura de Sombra Acústica" },
        { name: "TRIDENTE-06 [Enlace Litoral]", lat: -33.360, lon: -71.710, desc: "Algarrobo Norte - Conexión Inter-Puertos" },
        { name: "TRIDENTE-07 [Nodo San Antonio]", lat: -33.577, lon: -71.640, desc: "Punta Panul - Control Puerto Gran Escala" },
        { name: "TRIDENTE-08 [Cierre Sur]", lat: -34.133, lon: -72.020, desc: "Punta Topocalma - Alerta Temprana Sur" }
    ];

    // Renderizado de la Red de Sensores
    buoys.forEach(function(buoy) {
        
        // 1. Marcador de la Boya (Icono Táctico)
        L.circleMarker([buoy.lat, buoy.lon], {
            color: '#00FFFF', // Cian Táctico
            fillColor: '#00FFFF',
            fillOpacity: 1,
            radius: 5
        }).addTo(map).bindPopup("<b>" + buoy.name + "</b><br>" + buoy.desc);

        // 2. Zona Primaria: Identificación ZFolding (35 km / ~19 MN)
        // Zona donde extraemos RPM y Clase del motor.
        L.circle([buoy.lat, buoy.lon], {
            color: '#00FFFF',
            fillColor: '#00FFFF',
            fillOpacity: 0.1,
            radius: 35000, // Metros
            weight: 1
        }).addTo(map);

        // 3. Zona Secundaria: Alerta Temprana Dirac (70 km / ~38 MN)
        // Zona donde detectamos energía anómala (algo se acerca).
        L.circle([buoy.lat, buoy.lon], {
            color: '#FFD700', // Amarillo Alerta
            fill: false,
            dashArray: '5, 10', // Línea punteada
            radius: 70000, // Metros
            weight: 1
        }).addTo(map);
    });

    // Línea de Costa Simplificada (Referencia Visual)
    var latlngs = [
        [-32.143, -71.530], [-32.707, -71.500], [-32.923, -71.540], 
        [-33.018, -71.620], [-33.577, -71.610], [-34.133, -71.990]
    ];
    var polyline = L.polyline(latlngs, {color: 'gray', weight: 2, dashArray: '4'}).addTo(map);

</script>
